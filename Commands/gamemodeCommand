package me.ModMakerGroup.SM.Commands;

import java.io.File;

import me.ModMakerGroup.SM.ServerManager;

import org.bukkit.Bukkit;
import org.bukkit.ChatColor;
import org.bukkit.GameMode;
import org.bukkit.command.Command;
import org.bukkit.command.CommandExecutor;
import org.bukkit.command.CommandSender;
import org.bukkit.configuration.file.FileConfiguration;
import org.bukkit.configuration.file.YamlConfiguration;
import org.bukkit.entity.Player;

public class gamemodeCommand implements CommandExecutor
{
	  ServerManager main;
	  public gamemodeCommand(ServerManager sm) {
	    this.main = sm;
	  }

	  @SuppressWarnings("deprecation")
	  @Override
	  public boolean onCommand(CommandSender sender, Command cmd, String commandLabel, String[] args)
	  {
			File filem = null;
	    	if (main.getConfig().getString("General.Language").equals("en_EN")) {
	    		filem = new File("plugins/ServerManager/Languages", "en_EN.yml");
	    	} else if (main.getConfig().getString("General.Language").equals("de_DE")) {
	    		filem = new File("plugins/ServerManager/Languages", "de_DE.yml");
	    	} else if (main.getConfig().getString("General.Language").equals("es_ES")) {
	    		filem = new File("plugins/ServerManager/Languages", "es_ES.yml");
	    	}
	    	FileConfiguration cfg = YamlConfiguration.loadConfiguration(filem);
		  
		  if (cmd.getName().equalsIgnoreCase("gamemode")) {
			  Player p = (Player)sender;
		      if (!p.hasPermission("sm.gamemode")) {
		    	  p.sendMessage(ServerManager.prefix + ServerManager.KeineRechte);
		    	  return true;
		      }else{
		    	  if ((sender instanceof Player) && (args.length == 2)) {
		    		  if (Bukkit.getPlayer(args[1]) != null) {
		    			  Player target = Bukkit.getPlayer(args[1]);
		    			  	if (args[0].equalsIgnoreCase("0") || args[0].equalsIgnoreCase("survival")) {
		    			  		if(!target.getGameMode().equals(GameMode.SURVIVAL)) {
		    			  			target.setGameMode(GameMode.SURVIVAL);
		    			  			String gmc = cfg.getString("Gamemode.Change");
		    			  			gmc = ChatColor.translateAlternateColorCodes('&', gmc);
		    			  			gmc = gmc.replace("%gamemode%", "SURVIVAL");
		    			  			target.sendMessage(ServerManager.prefixb + gmc);
		    			  			String gmco = cfg.getString("Gamemode.Change other");
		    			  			gmco = ChatColor.translateAlternateColorCodes('&', gmco);
		    			  			gmco = gmco.replace("%gamemode%", "SURVIVAL");
		    			  			gmco = gmco.replace("%player%", target.getName());
		    			  			p.sendMessage(ServerManager.prefix + gmco);
		    			  		}else{
		    			  			String Isan = cfg.getString("Gamemode.Is same as now");
		    			  			Isan = ChatColor.translateAlternateColorCodes('&', Isan);
		    			  			Isan = Isan.replace("%gamemode%", "SURVIVAL");
		    			  			p.sendMessage(ServerManager.prefixb + Isan);		            		
		    			  		}
		    			  	} else if (args[0].equalsIgnoreCase("1") || args[0].equalsIgnoreCase("creativ")) {
		    			  		if (!target.getGameMode().equals(GameMode.CREATIVE)) {
		    			  			target.setGameMode(GameMode.CREATIVE);
		    			  			String gmc = cfg.getString("Gamemode.Change");
		    			  			gmc = ChatColor.translateAlternateColorCodes('&', gmc);
		    			  			gmc = gmc.replace("%gamemode%", "CREATIV");
		    			  			target.sendMessage(ServerManager.prefixb + gmc);
		    			  			String gmco = cfg.getString("Gamemode.Change other");
		    			  			gmco = ChatColor.translateAlternateColorCodes('&', gmco);
		    			  			gmco = gmco.replace("%gamemode%", "CREATIV");
		    			  			gmco = gmco.replace("%player%", target.getName());
		    			  			p.sendMessage(ServerManager.prefix + gmco);
		    			  		}else{
		    			  			String Isan = cfg.getString("Gamemode.Is same as now");
		    			  			Isan = ChatColor.translateAlternateColorCodes('&', Isan);
		    			  			Isan = Isan.replace("%gamemode%", "CREATIV");
		    			  			p.sendMessage(ServerManager.prefixb + Isan);
		            		
		    			  		}
		    			  	} else if (args[0].equalsIgnoreCase("2") || args[0].equalsIgnoreCase("adventure")) {
		    			  		if (!target.getGameMode().equals(GameMode.ADVENTURE)) {
		    			  			target.setGameMode(GameMode.ADVENTURE);
		    			  			String gmc = cfg.getString("Gamemode.Change");
		    			  			gmc = ChatColor.translateAlternateColorCodes('&', gmc);
		    			  			gmc = gmc.replace("%gamemode%", "ADVENTURE");
		    			  			target.sendMessage(ServerManager.prefixb + gmc);
		    			  			String gmco = cfg.getString("Gamemode.Change other");
		    			  			gmco = ChatColor.translateAlternateColorCodes('&', gmco);
		    			  			gmco = gmco.replace("%gamemode%", "ADVENTURE");
		    			  			gmco = gmco.replace("%player%", target.getName());
		    			  			p.sendMessage(ServerManager.prefix + gmco);
		    			  		}else{
		    			  			String Isan = cfg.getString("Gamemode.Is same as now");
		    			  			Isan = ChatColor.translateAlternateColorCodes('&', Isan);
		    			  			Isan = Isan.replace("%gamemode%", "ADVENTURE");
		    			  			p.sendMessage(ServerManager.prefixb + Isan);
		            		
		    			  		}
		    			  	}
		            
		    		  }
		              return true;
		          }
		          sender.sendMessage(ServerManager.prefixb + ServerManager.Playerdnx);
		        }
		    }		    
		    return true;
	  }
}
